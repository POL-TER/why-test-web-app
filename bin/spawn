#!/usr/bin/env node

const {spawn} = require('child_process');

const appProcess = spawn('bin/www', {stdio: 'inherit'});

let testProcess = null;

process.stdin.on('data', (data) => {
  if (data.toString().trim().toLowerCase() === 'test' && !testProcess) {

    console.log('Executing Tests');
    testProcess = spawn('npm', ['test'], {stdio: 'inherit'});
    
    testProcess.on('close', (data) => {
      testProcess = null;
    });
  }
});
